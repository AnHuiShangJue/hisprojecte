<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="description"
          content="Materialize is a Material Design Admin Template,It's modern, responsive and based on Material Design by Google. ">
    <meta name="keywords"
          content="materialize, admin template, dashboard template, flat admin template, responsive admin template,">
    <title th:text="${title}"></title>

    <link rel="apple-touch-icon" th:href="@{/accounts/assets/app-assets/images/favicon/apple-touch-icon-152x152.png}">
    <link rel="shortcut icon" type="image/x-icon"
          th:href="@{/accounts/assets/app-assets/images/favicon/favicon-32x32.png}">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- BEGIN: VENDOR CSS-->
    <link rel="stylesheet" type="text/css" th:href="@{/accounts/assets/app-assets/vendors/vendors.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/accounts/assets/app-assets/vendors/animate-css/animate.css}">
    <!-- END: VENDOR CSS-->
    <!-- BEGIN: Page Level CSS-->
    <link rel="stylesheet" type="text/css"
          th:href="@{/accounts/assets/app-assets/css/themes/vertical-menu-nav-dark-template/materialize.css}">
    <link rel="stylesheet" type="text/css"
          th:href="@{/accounts/assets/app-assets/css/themes/vertical-menu-nav-dark-template/style.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/accounts/assets/app-assets/css/pages/login.css}">
    <!-- END: Page Level CSS-->
    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" th:href="@{/accounts/assets/app-assets/css/custom/custom.css}">
    <!-- END: Custom CSS-->
    <link rel="stylesheet" type="text/css" th:href="@{/accounts/assets/app-assets/css/pages/dashboard-modern.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/accounts/assets/app-assets/css/pages/intro.css}">

    <link rel="stylesheet" type="text/css"
          th:href="@{/accounts/assets/app-assets/vendors/chartist-js/chartist.min.css}">
    <link rel="stylesheet" type="text/css"
          th:href="@{/accounts/assets/app-assets/vendors/chartist-js/chartist-plugin-tooltip.css}">


    <!--define Formcheck-->
    <script charset="utf-8" src="http://map.qq.com/api/js?v=2.exp"></script>


</head>
<body class="vertical-layout page-header-light vertical-menu-collapsible vertical-menu-nav-dark 1-column login-bg  blank-page blank-page"
      data-open="click" data-menu="vertical-menu-nav-dark" data-col="1-column">
<div class="row">
    <div class="col s12">
        <div class="container">
            <div id="login-page" class="row">
                <div class="col s12 m6 l4 z-depth-4 card-panel border-radius-6 login-card bg-opacity-8">
                    <form class="login-form formValidate" action="#" id="loginForm" method="get">
                        <div class="row">
                            <div class="input-field col s12">
                                <h5 class="ml-4">智慧园区系统</h5>
                                <h6 class="ml-4"></h6>
                            </div>
                        </div>
                        <div class="row">
                            <div class="row margin">
                                <div class="input-field col s12">
                                    <i class="material-icons prefix pt-2">person_outline</i>
                                    <label for="username" class="center-align active">账 号(Account)</label>
                                    <input id="username" name="username" type="text" data-error=".errorTxt1">
                                    <div class="errorTxt1"></div>
                                </div>
                            </div>
                            <div class="row margin">
                                <div class="input-field col s12">
                                    <i class="material-icons prefix pt-2">lock_outline</i>
                                    <label for="password" class="active">密 码</label>
                                    <input id="password" name="password" type="password" data-error=".errorTxt2">
                                    <div class="errorTxt2"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <button id="btn_login" name="action"
                                            class="btn waves-effect waves-light border-round gradient-45deg-purple-deep-orange col s12"
                                            type="submit">登 录
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- ================================================
  Scripts
  ================================================ -->


<!-- BEGIN VENDOR JS-->
<script th:src="@{/accounts/assets/app-assets/js/vendors.min.js}" type="text/javascript"></script>
<!-- BEGIN VENDOR JS-->
<script th:src="@{/accounts/assets/app-assets/vendors/chartjs/chart.min.js}" type="text/javascript"></script>
<script th:src="@{/accounts/assets/app-assets/vendors/chartist-js/chartist.min.js}" type="text/javascript"></script>
<script th:src="@{/accounts/assets/app-assets/vendors/chartist-js/chartist-plugin-tooltip.js}"
        type="text/javascript"></script>
<script th:src="@{/accounts/assets/app-assets/vendors/chartist-js/chartist-plugin-fill-donut.min.js}"
        type="text/javascript"></script>
<!-- BEGIN PAGE VENDOR JS-->
<!-- END PAGE VENDOR JS-->
<!-- BEGIN THEME  JS-->
<script th:src="@{/accounts/assets/app-assets/js/plugins.js}" type="text/javascript"></script>
<script th:src="@{/accounts/assets/app-assets/js/custom/custom-script.js}" type="text/javascript"
        src="/static/assets/app-assets/js/custom/custom-script.js"></script>
<!-- END THEME  JS-->

<!-- BEGIN PAGE VENDOR JS-->
<script th:src="@{/accounts/assets/app-assets/vendors/jquery-validation/jquery.validate.min.js}"
        type="text/javascript"></script>
<script th:src="@{/accounts/assets/app-assets/vendors/jquery-validation/localization/messages_zh.js}"
        type="text/javascript"></script>
<script th:src="@{/accounts/assets/app-assets/vendors/jquery-validation/additional-methods.js}"
        type="text/javascript"></script>
<!-- END PAGE VENDOR JS-->

<!-- BEGIN PAGE LEVEL JS-->
<script th:src="@{/accounts/assets/app-assets/js/scripts/intro.js}" type="text/javascript"></script>
<!-- END THEME  JS-->
<!-- BEGIN PAGE LEVEL JS-->
<!-- END PAGE LEVEL JS-->
<!-- END PAGE LEVEL JS-->
<!--layer的基础包-->
<script type="text/javascript" th:src="@{/accounts/assets/global/js/plugins/layer-v3.1.1/layer/layer.js}"></script>

<!--引入自定义的layer包-->
<script type="text/javascript" th:src="@{/accounts/assets/global/js/ahsj.layer.js}"></script>
<script type="text/javascript" th:src="@{/accounts/assets/global/js/anhuishangjue.ajax.js}"></script>

<script type="text/javascript">
    $(function () {
        formCheck();

    });

    function formCheck() {
        $("#loginForm").validate({
            rules: {
                username: {
                    required: true,
                    minlength: 3
                },
                password: {
                    required: true,
                    minlength: 3
                }
            },
            messages: {
                username: {
                    required: "请输入账号",
                    minlength: "最少包含三个字符"
                },
                password: {
                    required: "请输入密码",
                    minlength: "最少输入3个字符"
                },

            },
            errorElement: 'div',
            errorPlacement: function (error, element) {
                var placement = $(element).data('error');
                console.log("error is" + placement);
                if (placement) {
                    $(placement).append(error)
                } else {
                    error.insertAfter(element);
                }
            },
            submitHandler: function (form) {
                var username = $('#username').val();
                var password = $('#password').val();
                var user = {
                    "username": username,
                    "password": password,
                    "grant_type": "password",
                    "scope": "select",
                    "client_id": "bd1c0a783ccdd1c9b9e4",
                    "client_secret": "1a9030fbca47a5b2c28e92f19050bb77824b5ad1"
                };
                console.log(user.username);
                console.log(user.password);
                $.ajax({
                    type: "post",
                    data: user,
                    url: "/uaa/oauth/token",
                    dataType: "json",
                    success: function (msg) {
                        if (msg.access_token != null) {
                            console.log(msg);
                            M.toast({html:"登录成功"});
                            // $.cookie("Authorization", msg.access_token, {expires: 7});
                            window.location.href = "/accounts/his/back/index/index.ahsj?token="+msg.access_token
                        }
                    },
                    error: function (data) {
                        if (data.responseJSON != null) {
                            console.log(data);
                            M.toast({html:"登陆失败!" + data.responseJSON.error_description});
                        } else {
                            M.toast({html:"网络异常"});
                        }
                    }
                });
            }

        });
    }

</script>
</div>
</body>

</html>
